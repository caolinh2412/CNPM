"use strict";(self.__LOADABLE_LOADED_CHUNKS__=self.__LOADABLE_LOADED_CHUNKS__||[]).push([[13704,98234],{672485:(e,t,i)=>{i.r(t),i.d(t,{default:()=>l});let n={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"DeprecatedCarousel_pin",selections:[{alias:null,args:null,kind:"ScalarField",name:"entityId",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"imageSignature",storageKey:null},{args:null,kind:"FragmentSpread",name:"usePinCarouselData_pin"}],type:"Pin",abstractKey:null};n.hash="4be444081491499e2b6e9d6768314918";let l=n},520578:(e,t,i)=>{var n,l,a;i.r(t),i.d(t,{default:()=>s});let r={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"PinImage_pin",selections:[{alias:null,args:null,kind:"ScalarField",name:"altText",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"autoAltText",storageKey:null},{alias:null,args:null,concreteType:"PinCarouselData",kind:"LinkedField",name:"carouselData",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"dominantColor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"gridTitle",storageKey:null},{alias:"imageSpec_236x",args:[{kind:"Literal",name:"spec",value:"236x"}],concreteType:"ImageDetails",kind:"LinkedField",name:"images",plural:!1,selections:a=[n={alias:null,args:null,kind:"ScalarField",name:"height",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"url",storageKey:null},l={alias:null,args:null,kind:"ScalarField",name:"width",storageKey:null}],storageKey:'images(spec:"236x")'},{alias:"imageSpec_474x",args:[{kind:"Literal",name:"spec",value:"474x"}],concreteType:"ImageDetails",kind:"LinkedField",name:"images",plural:!1,selections:a,storageKey:'images(spec:"474x")'},{alias:"imageSpec_736x",args:[{kind:"Literal",name:"spec",value:"736x"}],concreteType:"ImageDetails",kind:"LinkedField",name:"images",plural:!1,selections:a,storageKey:'images(spec:"736x")'},{alias:"imageSpec_orig",args:[{kind:"Literal",name:"spec",value:"orig"}],concreteType:"ImageDetails",kind:"LinkedField",name:"images",plural:!1,selections:a,storageKey:'images(spec:"orig")'},{alias:null,args:null,kind:"ScalarField",name:"storyPinDataId",storageKey:null},{alias:null,args:null,concreteType:"Video",kind:"LinkedField",name:"videos",plural:!1,selections:[{alias:null,args:null,concreteType:"VideoList",kind:"LinkedField",name:"videoList",plural:!1,selections:[{alias:null,args:null,concreteType:"VideoDetail",kind:"LinkedField",name:"vHLSV4",plural:!1,selections:[n,{alias:null,args:null,kind:"ScalarField",name:"thumbnail",storageKey:null},l],storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"title",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"isThirdPartyAd",storageKey:null},{args:null,kind:"FragmentSpread",name:"StoryPinImage_pin"},{args:null,kind:"FragmentSpread",name:"DeprecatedCarousel_pin"}],type:"Pin",abstractKey:null};r.hash="228ed96182ff017f2d866065cbecf7b9";let s=r},415244:(e,t,i)=>{i.r(t),i.d(t,{default:()=>l});let n={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"PinVideoWithVisibility_pin",selections:[{alias:null,args:null,kind:"ScalarField",name:"entityId",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"isPromoted",storageKey:null},{args:null,kind:"FragmentSpread",name:"PinVideo_pin"},{args:null,kind:"FragmentSpread",name:"useAutoplayOrgVideoOnHover_pin"}],type:"Pin",abstractKey:null};n.hash="8e6a9272e57ad1033c4bf432c3adf854";let l=n},787761:(e,t,i)=>{var n,l;i.r(t),i.d(t,{default:()=>r});let a={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"PinVideo_pin",selections:[n={alias:null,args:null,kind:"ScalarField",name:"entityId",storageKey:null},{alias:"imageSpec_236x",args:[{kind:"Literal",name:"spec",value:"236x"}],concreteType:"ImageDetails",kind:"LinkedField",name:"images",plural:!1,selections:[l={alias:null,args:null,kind:"ScalarField",name:"url",storageKey:null}],storageKey:'images(spec:"236x")'},{alias:null,args:null,kind:"ScalarField",name:"isDownstreamPromotion",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"isEligibleForWebCloseup",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"isPromoted",storageKey:null},{alias:null,args:null,concreteType:"User",kind:"LinkedField",name:"promoter",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"Video",kind:"LinkedField",name:"videos",plural:!1,selections:[n,{alias:null,args:null,concreteType:"VideoList",kind:"LinkedField",name:"videoList",plural:!1,selections:[{alias:null,args:null,concreteType:"VideoDetail",kind:"LinkedField",name:"vHLSV4",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"height",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"thumbnail",storageKey:null},l,{alias:null,args:null,kind:"ScalarField",name:"width",storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null},{args:null,kind:"FragmentSpread",name:"PinImage_pin"}],type:"Pin",abstractKey:null};a.hash="72a606f26ad161609980c86fe071d95e";let r=a},313704:(e,t,i)=>{var n,l,a,r;i.r(t),i.d(t,{default:()=>o});let s=(r={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},{argumentDefinitions:[],kind:"Fragment",metadata:null,name:"StoryPinImage_pin",selections:[{alias:null,args:null,kind:"ScalarField",name:"dominantColor",storageKey:null},{alias:"imageSpec_474x",args:[{kind:"Literal",name:"spec",value:"474x"}],concreteType:"ImageDetails",kind:"LinkedField",name:"images",plural:!1,selections:a=[n={alias:null,args:null,kind:"ScalarField",name:"height",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"url",storageKey:null},l={alias:null,args:null,kind:"ScalarField",name:"width",storageKey:null}],storageKey:'images(spec:"474x")'},{alias:"imageSpec_736x",args:[{kind:"Literal",name:"spec",value:"736x"}],concreteType:"ImageDetails",kind:"LinkedField",name:"images",plural:!1,selections:a,storageKey:'images(spec:"736x")'},{alias:null,args:null,kind:"ScalarField",name:"isDownstreamPromotion",storageKey:null},{alias:null,args:null,concreteType:"User",kind:"LinkedField",name:"promoter",plural:!1,selections:[r],storageKey:null},{alias:null,args:null,concreteType:"StoryPinData",kind:"LinkedField",name:"storyPinData",plural:!1,selections:[{alias:null,args:null,concreteType:"StoryPinPage",kind:"LinkedField",name:"pages",plural:!0,selections:[{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"blocks",plural:!0,selections:[r,{kind:"InlineFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"blockType",storageKey:null},{alias:null,args:null,concreteType:"StoryPinVideoMetadata",kind:"LinkedField",name:"video",plural:!1,selections:[{alias:null,args:null,concreteType:"StoryPinVideoFormats",kind:"LinkedField",name:"videoList",plural:!1,selections:[{alias:null,args:null,concreteType:"VideoDetail",kind:"LinkedField",name:"vHLSV3MOBILE",plural:!1,selections:[n,{alias:null,args:null,kind:"ScalarField",name:"thumbnail",storageKey:null},l],storageKey:null}],storageKey:null}],storageKey:null}],type:"StoryPinVideoBlock",abstractKey:null}],storageKey:null}],storageKey:null}],storageKey:null}],type:"Pin",abstractKey:null});s.hash="d7067d1e94374c13353df624e2cb90dc";let o=s},981102:(e,t,i)=>{i.r(t),i.d(t,{default:()=>l});let n={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"VideoWithContextLogging_pin",selections:[{args:null,kind:"FragmentSpread",name:"VideoWrapper_pin"}],type:"Pin",abstractKey:null};n.hash="93ed23334d5bac81ac8410f05c4f2031";let l=n},974179:(e,t,i)=>{var n,l;i.r(t),i.d(t,{default:()=>r});let a={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"useAutoplayOrgVideoOnHover_pin",selections:[n={alias:null,args:null,kind:"ScalarField",name:"entityId",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"isPromoted",storageKey:null},{alias:null,args:null,concreteType:"StoryPinData",kind:"LinkedField",name:"storyPinData",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"totalVideoDuration",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"Video",kind:"LinkedField",name:"videos",plural:!1,selections:[n,{alias:null,args:null,concreteType:"VideoList",kind:"LinkedField",name:"videoList",plural:!1,selections:[{alias:null,args:null,concreteType:"VideoDetail",kind:"LinkedField",name:"v720P",plural:!1,selections:l=[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"VideoDetail",kind:"LinkedField",name:"vHLSV4",plural:!1,selections:l,storageKey:null},{alias:null,args:null,concreteType:"VideoDetail",kind:"LinkedField",name:"vHLSV3MOBILE",plural:!1,selections:l,storageKey:null}],storageKey:null}],storageKey:null}],type:"Pin",abstractKey:null};a.hash="2942f85ec1d9274bd2a1e72a4b5cf008";let r=a},601143:(e,t,i)=>{i.d(t,{Z:()=>C}),i(167912);var n,l,a=i(616550),r=i(693967),s=i.n(r),o=i(883119),d=i(315376),u=i(261821),c=i(384609),h=i(144326),g=i(240760),p=i(945960),m=i(297728),y=i(561360),v=i(969119),f=i(470761),x=i(785893);function S(e){return!(e.imageSpec_474x?.width&&e.imageSpec_474x.height&&e.imageSpec_474x.width>e.imageSpec_474x.height)&&e.imageSpec_474x||e.imageSpec_736x}let b=void 0!==n?n:n=i(313704);function _({alt:e,fetchPriority:t,onError:i=()=>{},onLoad:n=()=>{},pinKey:l,_fixCompletedOnLoad:a}){let{checkExperiment:r}=(0,m.F)(),{anyEnabled:s}=r("ads_iad_dweb"),d=(0,c.Z)(b,l),{dominantColor:u,isDownstreamPromotion:h,promoter:g}=d,p=!!g&&!h,y=function(e){let t=e.storyPinData?.pages||[],i=(t[0]?.blocks||[])[0]||{};return"StoryPinVideoBlock"===i.__typename&&3===i.blockType}(d),{height:v,width:_,url:w}=function({pin:e,useVideoThumbnail:t}){return t?function(e){let t=e.storyPinData?.pages||[],i=t[0]?.blocks||[],n=i[0]?.__typename==="StoryPinVideoBlock"?i[0]?.video?.videoList?.vHLSV3MOBILE:null;return n?.thumbnail?{height:n?.height||0,width:n?.width||0,url:n.thumbnail||""}:S(e)}(e):S(e)}({pin:d,useVideoThumbnail:y&&(p&&s||!p)})??{};return(0,x.jsx)(o.xu,{dangerouslySetInlineStyle:{__style:{zIndex:f.Z.storyPinImage}},"data-test-id":"story-pin-image-box",width:"100%",children:w&&(0,x.jsx)(o.Ee,{_fixCompletedOnLoad:a,alt:e,color:u||"transparent",fetchPriority:t,naturalHeight:v??1,naturalWidth:_??1,onError:i,onLoad:n,src:w})})}var w=i(827423),k=i(630075),P=i(865735),T=i(415787);let I=["ShoppingCarousel","ShoppingGridSmall","ShoppingGridSmallCarousel","ShoppingDynamicHeightGrid","VisualInspirationFocusPin","VisualInspirationPin","VisualInspirationShoppingPin"],L=void 0!==l?l:l=i(520578),F=({children:e,cropStoryPinImage:t,cropWidth:i,cropHeight:n})=>t?(0,x.jsx)(o.kC,{alignItems:"center",height:i?n:void 0,justifyContent:"start",width:i||void 0,children:e}):(0,x.jsx)(o.xu,{children:e}),C=({cropHeight:e,cropWidth:t,highResOnly:i,imageFit:n,isInDesktopCarousel:l,onError:r,onLoad:f,pinKey:S,saved:b=!1,surface:C,ssrImpressionFixEnabled:j})=>{let D=(0,h.ZP)(),V=(0,w.C)((0,a.TH)()),K=(0,c.Z)(L,S),{checkExperiment:E}=(0,m.F)(),{altText:A,autoAltText:H,carouselData:M,description:W="",dominantColor:Z,gridTitle:B,isThirdPartyAd:O,title:z,videos:R}=K,$=(0,g.nk)(D.bt("Mục này có hình ảnh của: {{ pinTitle }}", "This contains an image of: {{ pinTitle }}", "web.altText", undefined, true),{pinTitle:z||B}).join(""),N="",U,G=0,q=0;if(K.imageSpec_736x||K.imageSpec_orig||K.imageSpec_474x||K.imageSpec_236x){let e=K.imageSpec_236x;if(i)e=K.imageSpec_736x||K.imageSpec_orig||K.imageSpec_474x||K.imageSpec_236x;else{let{thumbnail:t,height:i,width:n}=R?.videoList?.vHLSV4||{};e=t?{url:t,height:i??1,width:n??1}:e}G=e?.height,q=e?.width,N=e?.url,U=i?e?.url?`${e.url} 1x`:"":[K.imageSpec_236x?.url&&`${K.imageSpec_236x.url} 1x`,K.imageSpec_474x?.url&&`${K.imageSpec_474x.url} 2x`,K.imageSpec_736x?.url&&`${K.imageSpec_736x.url} 3x`,K.imageSpec_orig?.url&&`${K.imageSpec_orig.url} 4x`].filter(Boolean).join(", ")}let J=E("preload_grid_images",{dangerouslySkipActivation:!0}).anyEnabled,Q=e=>{let t=new Image;t.src=e;let{complete:i}=t;return t.src="",i},Y=["originals","736x","474x","236x"],X=new RegExp(/\/(\d+x|originals)\//),ee=e=>{let t=e.match(X),i=t?t[1]:null,n=(0,y.Z)("resource").filter(e=>"link"===e.initiatorType&&e.name.includes("i.pinimg.com")),l=new Set;return Y.forEach(t=>{let i=e.replace(X,`/${t}/`);n.filter(e=>e.name===i).length>0&&l.add(t)}),l.size>0&&!!i&&!l.has(i)||l.size>1},et=(e,t)=>{let i=Math.round(Number(window.devicePixelRatio)),n="";i&&(n=2===i?"474x":3===i?"736x":4===i?"orig":"236x");let l=e.replace(X,`/${n}/`),a=ee(e);Q(l)?(0,T.nP)(`web.${t}.cached_grid_image.found`,{tags:{resolution:n,isPreloadGridImagesEnabled:J,areMultipleResolutionsLoaded:a}}):(0,T.nP)(`web.${t}.cached_grid_image.not_found`,{tags:{resolution:n,isPreloadGridImagesEnabled:J,areMultipleResolutionsLoaded:a}})};(0,v.Z)(()=>{if(N?.startsWith("https://i.pinimg.com/")&&C){let e="";C.includes("Search")?e="search":C.includes("AuthHomefeed")&&(e="auth_homefeed"),e&&et(N,e)}});let ei=(0,d.Z)({altText:A,autoAltText:H,i18n:D})||!!W?.trim().length&&W||$;if(M)return(0,x.jsx)(k.Z,{_fixCompletedOnLoad:j,highResOnly:i,isThirdPartyAd:O,onError:r,onLoad:f,pinKey:K});let en=["ShoppingGridSmall","ShoppingGridSmallCarousel"].includes(C)?void 0:p.Ml,el=(0,P.Z)(C);return(0,x.jsx)(o.kC,{alignItems:"center",justifyContent:"start",minHeight:en,children:(0,x.jsx)(o.xu,{flex:"grow",children:(0,x.jsx)("div",{className:s()({savedGradient:b}),children:K.storyPinDataId?(0,x.jsx)(F,{cropHeight:e,cropStoryPinImage:!!t&&(I.includes(C)||!!l),cropWidth:t,children:(0,x.jsx)(_,{_fixCompletedOnLoad:j,alt:ei,fetchPriority:V?"low":void 0,onError:r,onLoad:f,pinKey:K})}):(0,x.jsx)(o.xu,{"data-test-id":"non-story-pin-image",height:t?e:void 0,width:t||void 0,children:(0,x.jsx)(u.Z,{_fixCompletedOnLoad:j,alt:ei,color:"dominant"===el?Z??"":el,crossOrigin:O?"anonymous":void 0,fetchPriority:V?"low":void 0,fit:n,naturalHeight:G??1,naturalWidth:q??1,onError:r,onLoad:f,src:N??"",srcSet:U})})})})})}},98234:(e,t,i)=>{i.r(t),i.d(t,{default:()=>j});var n,l,a,r=i(667294);i(167912);var s=i(883119),o=i(601143),d=i(384609),u=i(891985),c=i(830017),h=i(414373),g=i(368611),p=i(412497),m=i(144326),y=i(785893);let v={__style:{backgroundColor:"#000"}};function f({backgroundImage:e,naturalHeight:t,naturalWidth:i,onRestartVideo:n,pinId:l}){let a=(0,m.ZP)();return(0,y.jsxs)(s.Ee,{alt:a.bt("hình ảnh ghim", "pin image", "image of a pin", undefined, true),naturalHeight:t,naturalWidth:i,src:e,children:[(0,y.jsx)(s.xu,{bottom:!0,dangerouslySetInlineStyle:v,left:!0,opacity:.8,position:"absolute",right:!0,top:!0}),(0,y.jsxs)(s.xu,{"data-test-id":`video-end-card-${l}`,direction:"column",display:"flex",height:"100%",justifyContent:"center",position:"absolute",width:"100%",children:[(0,y.jsx)(s.iP,{rounding:2,children:(0,y.jsxs)(s.xu,{display:"flex",justifyContent:"center",padding:2,children:[(0,y.jsx)(s.JO,{accessibilityLabel:a.bt("Truy cập trang", "Visit site", "Button when pressed goes to pin's website", undefined, true),color:"light",dangerouslySetSvgPath:{__path:g.Z},size:25}),(0,y.jsx)(s.xu,{margin:1}),(0,y.jsx)(s.xv,{color:"light",lineClamp:1,weight:"bold",children:a.bt("Truy cập trang", "Visit site", "Button when pressed goes to pin's website", undefined, true)})]})}),(0,y.jsx)(s.xu,{margin:3}),(0,y.jsx)(s.iP,{onTap:n,rounding:2,children:(0,y.jsxs)(s.xu,{display:"flex",justifyContent:"center",padding:2,children:[(0,y.jsx)(s.JO,{accessibilityLabel:a.bt("Xem lại", "Watch again", "Button when pressed restarts the video", undefined, true),color:"light",dangerouslySetSvgPath:{__path:p.Z},size:25}),(0,y.jsx)(s.xu,{margin:1}),(0,y.jsx)(s.xv,{color:"light",lineClamp:1,weight:"bold",children:a.bt("Xem lại", "Watch again", "Button when pressed restarts the video", undefined, true)})]})})]})]})}function x({aspectRatio:e,children:t}){return(0,y.jsx)(s.xu,{dangerouslySetInlineStyle:{__style:{aspectRatio:e}},children:t})}var S=i(966875);let b=new Set(["ConversationView","TodayTabFeed"]),_=void 0!==n?n:n=i(787761);function w({isAutoplay:e,cropHeight:t,currentTime:i,highResOnly:n,onLoad:l,onError:a,saved:g,onTimeChange:p,isExperimentalPinRep:m,pinKey:v,surface:w,playing:k,rootMargin:P,viewType:T,viewParameter:I,cropWidth:L,video:F}){let C;let[j,D]=(0,r.useState)(!1),[V,K]=(0,r.useState)(!k),E=(0,d.Z)(_,v),{isDownstreamPromotion:A,promoter:H}=E,M=(0,u.jL)(!!A,!!H),W=M&&!E.isEligibleForWebCloseup,Z=m&&M&&E.isEligibleForWebCloseup&&!b.has(w),{setCurrentVideo:B}=(0,c.I)();e&&k&&V&&K(!1);let{url:O}=E.imageSpec_236x??{},{entityId:z,isPromoted:R}=E,$=(0,r.useCallback)(({event:e})=>{e.preventDefault(),e.stopPropagation(),B({pinId:z,isPromoted:!!R,currentTime:0}),D(!1)},[R,z,B]),N=(0,r.useCallback)(()=>{R&&D(Z)},[Z,R]),U=F??E.videos?.videoList?.vHLSV4;if(!U)return null;let{height:G,thumbnail:q,width:J,url:Q}=U,Y=F?.entityId??E.videos?.entityId??"",X=(J??1)/(G??1),ee=w&&(0,h.Z)(w)&&"UserProfilePinGrid"!==w;if(ee&&(X=1,C="transparent"),j&&M)return(0,y.jsx)(s.xu,{children:(0,y.jsx)(f,{backgroundImage:O??"",naturalHeight:G??1,naturalWidth:J??1,onRestartVideo:$,pinId:z})});let et={highResOnly:n,onError:a,onLoad:l,pinKey:E,saved:g};ee&&(et={...et,cropHeight:t,cropWidth:L,imageFit:"contain"});let ei=(0,y.jsx)(s.xu,{"data-test-id":"pinrep-video--placeholder","data-test-image-signature":O,children:(0,y.jsx)(x,{aspectRatio:X,children:(0,y.jsx)(o.Z,{...et,ssrImpressionFixEnabled:!1,surface:w})})});return V?ei:(0,y.jsx)(s.xu,{children:(0,y.jsx)(S.ZP,{aspectRatio:X,backgroundColor:C,captions:"",contextLogData:{viewParameter:I,component:0,objectId:z,video_id:Y,view:T},fallback:ei,hlsConfig:{capLevelToPlayerSize:!0,startPosition:i||-1},isAutoPlay:!!e,loop:W||!m||!M,onEnded:N,onPlay:()=>{},onPlayError:()=>{},onTimeChange:p,playing:k,poster:O||q||void 0,rootMargin:P,src:[{type:"video/m3u8",src:Q}]??[],surface:w,videoStartTime:i,volume:0})})}var k=i(159574),P=i(439839),T=i(819239);let I=void 0!==l?l:l=i(974179);function L(e,t,i){var n;return(t="symbol"==typeof(n=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,t||"default");if("object"!=typeof n)return n;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?n:n+"")in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}let F=void 0!==a?a:a=i(415244);class C extends r.Component{constructor(...e){super(...e),L(this,"calculateCurrentVideoTime",()=>{let{currentTimeFromPinRep:e,pin:t,videosAutoplaying:i}=this.props,{entityId:n}=t,l=(0,P.Z)(n,i);return this.currentVideoCurrentTime||l||e}),L(this,"handleVisibilityChanged",e=>{let{currentTimeFromPinRep:t,pin:i,setCurrentVideo:n,pauseAutoplay:l,videosAutoplaying:a}=this.props,{entityId:r,isPromoted:s}=i,o=(0,T.Z)(r,a),d=function(e,t){let{organicVideosAutoplaying:i,promotedVideosAutoplaying:n}=t,l={...i,...n};for(let t in l){let{paused:i}=l[t];if(t!==e&&!i)return!1}return!0}(r,a);e?s?n({pinId:r,isPromoted:s,currentTime:this.calculateCurrentVideoTime()}):d&&n({pinId:r,isPromoted:!!s,currentTime:this.calculateCurrentVideoTime()}):!e&&o&&l({pinId:r,isPromoted:!!s,currentTime:t||this.currentVideoCurrentTime})}),L(this,"handleVideoTimeChange",e=>{let{pin:t,onTimeChange:i,videosAutoplaying:n}=this.props,{entityId:l}=t;(0,T.Z)(l,n)&&(this.currentVideoCurrentTime=e.time),i&&i(e)})}componentDidMount(){this.props.onLoad&&this.props.onLoad()}componentDidUpdate(e){let{appInFocus:t}=e,{appInFocus:i,currentTimeFromPinRep:n,pauseAutoplay:l,pin:a,setCurrentVideo:r,videosAutoplaying:s}=this.props,{entityId:o,isPromoted:d}=a,u=(0,T.Z)(o,s);i!==t&&!i&&u?(this.pausedDueToBrowserOutOfFocus=!0,l({pinId:o,isPromoted:!!d,currentTime:n||this.currentVideoCurrentTime})):this.pausedDueToBrowserOutOfFocus&&i&&(this.pausedDueToBrowserOutOfFocus=!1,r({pinId:o,isPromoted:!!d,currentTime:this.calculateCurrentVideoTime()}))}componentWillUnmount(){let{currentTimeFromPinRep:e,pauseAutoplay:t,pin:i,videosAutoplaying:n}=this.props,{entityId:l,isPromoted:a}=i;(0,T.Z)(l,n)&&t({pinId:l,isPromoted:!!a,currentTime:e||this.currentVideoCurrentTime})}render(){let{cropHeight:e,isAutoplay:t,pin:i,surface:n,videosAutoplaying:l,viewParameter:a,viewType:r,highResOnly:s,onError:o,onLoad:d,saved:u,isExperimentalPinRep:c,rootMargin:h,cropWidth:g,video:p}=this.props,{entityId:m}=i,v=(0,P.Z)(m,l),f=(0,T.Z)(m,l),x={cropHeight:e,rootMargin:h,currentTime:v,isAutoplay:t,viewParameter:a,viewType:r,onTimeChange:this.handleVideoTimeChange,onVisibilityChanged:this.handleVisibilityChanged,pinKey:i,surface:n,playing:f&&t,trackFullVisible:!1,highResOnly:s,onError:o,onLoad:d,saved:u,isExperimentalPinRep:c,cropWidth:g,...p?{video:p}:{}};return(0,y.jsx)(k.Z,{onVisibilityChanged:this.handleVisibilityChanged,rootMargin:h,trackFullVisible:x.trackFullVisible,children:(0,y.jsx)(w,{...x})})}}function j({pinKey:e,isHovering:t=!1,...i}){let{appUI:{appInFocus:n,isAutoplay:l,videosAutoplaying:a},pauseAutoplay:s,setCurrentVideo:o}=(0,c.I)(),u=(0,d.Z)(F,e),h=(0,r.useRef)(t);return!function({pinKey:e,isHovering:t,hoverState:i}){let n=(0,d.Z)(I,e),{setCurrentVideo:l,pauseAutoplay:a,appUI:{videosAutoplaying:s}}=(0,c.I)(),o=n?.videos?.videoList?.v720P||n?.videos?.videoList?.vHLSV4||n?.videos?.videoList?.vHLSV3MOBILE;(0,r.useEffect)(()=>{if(n){if(i.current!==t){let{entityId:e,isPromoted:i,storyPinData:r}=n,d=(0,P.Z)(e,s);if(o||r?.totalVideoDuration){if(t){let t=function(e,t){let{currentlyPlayingOrganicVideoId:i,organicVideosAutoplaying:n}=t;return i&&i!==e?i:Object.keys(n).find(e=>!1===n[e].paused)}(e,s);t&&a({currentTime:d,pinId:t,isPromoted:!1}),l({currentTime:d,pinId:e,isPromoted:!!i})}else i||a({currentTime:d,pinId:e,isPromoted:!!i})}}i.current=t}},[t,i,a,n,l,o,s])}({pinKey:u,isHovering:t,hoverState:h}),(0,y.jsx)(C,{...i,appInFocus:n,isAutoplay:l,pauseAutoplay:s,pin:u,setCurrentVideo:o,videosAutoplaying:a})}},368611:(e,t,i)=>{i.d(t,{Z:()=>n});let n="M17.496 14.572a1 1 0 0 1-1 1h-.001a1.001 1.001 0 0 1-.999-1.001l.002-4.652-7.29 7.288a.995.995 0 0 1-.707.293.999.999 0 0 1-.707-1.707l7.293-7.29L9.428 8.5a1 1 0 0 1 .001-2h.001l8.071.005-.005 8.067zM12 0C5.373 0 0 5.373 0 12c0 6.628 5.373 12 12 12 6.628 0 12-5.372 12-12 0-6.627-5.372-12-12-12z"},412497:(e,t,i)=>{i.d(t,{Z:()=>n});let n="M12 18.5A6.508 6.508 0 0 1 5.5 12c0-1.706.689-3.307 1.835-4.5H6.5a1 1 0 1 1 0-2h4.185v4.474a1 1 0 0 1-2 0V8.972A4.505 4.505 0 0 0 7.5 12c0 2.481 2.019 4.5 4.5 4.5s4.5-2.019 4.5-4.5a4.49 4.49 0 0 0-3.112-4.283 1 1 0 1 1 .615-1.902A6.482 6.482 0 0 1 18.5 12c0 3.584-2.916 6.5-6.5 6.5M12 0C5.373 0 0 5.373 0 12s5.373 12 12 12 12-5.373 12-12S18.627 0 12 0"},766546:(e,t,i)=>{i.d(t,{Z:()=>r});var n=i(667294);function l(e,t,i){var n;return(t="symbol"==typeof(n=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,t||"default");if("object"!=typeof n)return n;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?n:n+"")in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}class a extends n.Component{constructor(...e){super(...e),l(this,"ref",(0,n.createRef)()),l(this,"observer",null),l(this,"handleVisibilityChanged",(e,t)=>{this.props.onVisibilityChange(e,t)})}componentDidMount(){this.ref&&this.ref.current&&(this.observer=new window.IntersectionObserver(this.handleVisibilityChanged,this.props.options),this.observer.observe(this.ref.current))}componentWillUnmount(){this.observer&&(this.observer.unobserve(this.ref.current),delete this.observer)}render(){return this.props.children(this.ref)}}let r=a},561360:(e,t,i)=>{i.d(t,{Z:()=>n});function n(e){return window?.performance?.getEntriesByType&&window.performance.getEntriesByType(e)||[]}},159574:(e,t,i)=>{i.d(t,{Z:()=>r});var n=i(883119),l=i(291716),a=i(785893);function r({onVisibilityChanged:e,children:t,...i}){let r=(0,l.Z)({onVisibilityChanged:e,...i});return(0,a.jsx)(n.xu,{ref:r,children:t})}},291716:(e,t,i)=>{i.d(t,{Z:()=>u});var n=i(667294);let l=new Map,a=null,r=e=>{e.forEach(e=>{let t=l.get(e.target);t&&t(e)})},s=e=>{a.unobserve(e),l.delete(e)},o=(e,t="-64px 0px 0px 0px",i)=>{let n={root:"undefined"==typeof document?null:document.querySelector("#mainContainer"),rootMargin:t,threshold:[0,.5,1]};a=a||new window.IntersectionObserver(r,n),l.set(e,i),a.observe(e)},d=e=>l.has(e);function u({onVisibilityChanged:e,trackFullVisible:t,rootMargin:i}){let a=(0,n.useRef)(null),r=!1,u=t=>{(r=t.intersectionRatio>0||t.isIntersecting)&&e(!0)},c=()=>{a.current instanceof HTMLElement&&d(a.current)&&r&&(e(!1),r=!1)},h=(0,n.useCallback)(e=>{a.current instanceof HTMLElement&&o(a.current,e,e=>{if(!l.has(a.current))return;let i=t?e.intersectionRatio>=1:e.intersectionRatio>=.5,n=t?0===e.intersectionRatio:!i;!r&&i?u(e):r&&n&&c()})},[a.current]);return(0,n.useEffect)(()=>(h(i),()=>{a.current instanceof HTMLElement&&(c(),s(a.current))}),[h]),a}},439839:(e,t,i)=>{i.d(t,{Z:()=>n});function n(e,t){let{organicVideosAutoplaying:i,promotedVideosAutoplaying:n}=t,l={...i,...n};return l[e]&&l[e].currentTime}},470761:(e,t,i)=>{i.d(t,{Z:()=>n});let n={debugPinImpressions:999,max:9999,pinActionWrapper:101,saved:102,storyPinImage:-1}},827423:(e,t,i)=>{i.d(t,{C:()=>n,_:()=>r});let n=e=>!!e&&/^\/pin\/[\w-]+\/?$/.test(e.pathname),l=({pathname:e})=>/^\/search\/pins\//.test(e),a=({pathname:e,search:t})=>{let i=/^\/search\/pins\/(\?.*)$/.exec(e),n=(t||i&&i[1]||"").substr(1).split("&").map(e=>e.split("=")).find(e=>"q"===e[0]);return n?decodeURIComponent(n[1]):""},r=e=>{let t=[...e].reverse().find(({location:e})=>e&&!n(e));return t&&t.location&&l(t.location)?a(t.location):""}},630075:(e,t,i)=>{i.d(t,{Z:()=>_});var n,l=i(667294);i(422578);var a=i(883119),r=i(129666),s=i(384609),o=i(679482),d=i(144326),u=i(945960),c=i(297728),h=i(730212),g=i(107698),p=i(87416),m=i(785893);function y(e,t,i){var n;return(t="symbol"==typeof(n=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,t||"default");if("object"!=typeof n)return n;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?n:n+"")in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}let v=void 0!==n?n:n=i(672485),f=e=>{let t=e.reduce((e,t)=>{let{imageSizeMap:i}=t,{height:n,width:l}=i?.["736x"]||i?.["236x"]||{},a=`${l??1}x${n??1}`,r=e[a]?.times||0;return{...e,[a]:{imageHeight:n,imageWidth:l,times:r+1}}},{}),i=Object.keys(t).reduce((e,i)=>t[i].times>e.times?t[i]:e,{times:-1,imageHeight:-1,imageWidth:-1});return Object.keys(t).length>1?{imageHeight:i.imageHeight,imageWidth:i.imageWidth}:null},x=(e,t,i,n,l,r,s,o,d,u,c,h,p,y,v,f)=>{let x;let{imageSizeMap:S,details:b=""}=i,_=236,w=236,k="";r?(_=474,w=S&&Math.min(_/.8,_/((S["564x"]?.width??1)/(S["564x"]?.height??1))),k=S&&S["564x"]?.url):S&&S["736x"]?(w=S&&S["736x"]&&S["736x"].height,_=S&&S["736x"]&&S["736x"].width,k=S&&S["736x"]&&S["736x"].url):S&&S["236x"]&&(w=S&&S["236x"]&&S["236x"].height,_=S&&S["236x"]&&S["236x"].width,k=S&&S["236x"]&&S["236x"].url),p&&y&&(w=Math.min(p*y,w??1)),x=r?`${S?.["564x"]?.url??""} 1x`:[S?.["474x"]&&`${S["474x"].url??""} 2x`,S?.["736x"]&&`${S["736x"].url??""} 3x`,S?.orig&&`${S.orig.url??""} 4x`].filter(Boolean).join(", ");let P=(0,g.GH)(b,t,l),T=h?void 0:w,I=h?void 0:_,{boxHeight:L,boxWidth:F}=v?{boxHeight:v?.imageHeight,boxWidth:v?.imageWidth}:{boxHeight:T,boxWidth:I};return(0,m.jsx)(a.xu,{"data-test-id":"carousel-slot-container",height:L??void 0,width:F??void 0,children:(0,m.jsx)(a.xu,{"data-test-id":`carousel-img-${l}`,height:h?c:void 0,width:h||void 0,children:k&&(0,m.jsx)(a.Ee,{_fixCompletedOnLoad:e,alt:P,crossOrigin:f?"anonymous":void 0,fit:h?"cover":"none",naturalHeight:w??1,naturalWidth:_??1,onError:s,onLoad:o,src:k,srcSet:x})})},`carousel-slot-${n}-${l}`)},S=({pinId:e,slot:t,slotIndex:i,onError:n,onLoad:l,widthToUse:r,gap:s},o)=>{let{url:d,width:u,height:c}=["564x","736x","474x","236x"].map(e=>t.imageSizeMap?.[e]).find(e=>e?.url)||{},{details:h=""}=t,p=(0,g.GH)(h,o,i);return(0,m.jsx)(a.xu,{"data-test-id":"carousel-slot-container",height:"100%",marginEnd:s,width:r,children:(0,m.jsx)(a.zd,{height:"100%",wash:!0,children:d&&(0,m.jsx)(a.Ee,{alt:p,fit:"contain",naturalHeight:c??1,naturalWidth:u??1,onError:n,onLoad:l,src:d})})},`carousel-slot-${e}-${i}`)};class b extends l.Component{constructor(...e){super(...e),y(this,"state",{showBadge:!0,startImpressionTimer:!1}),y(this,"renderBadge",()=>{let{carouselData:e,isCloseup:t,showCarouselBadge:i}=this.props;if(!e)return null;let{showBadge:n}=this.state,{carouselSlots:l,index:r}=e;return!t&&i?(0,m.jsx)(a.xu,{alignItems:"center",color:"selected",dangerouslySetInlineStyle:{__style:{opacity:n?.8:0,transition:"opacity .3s"}},"data-test-id":"carousel-badge",display:"flex",height:35,justifyContent:"center",marginEnd:5,marginTop:5,position:"absolute",right:!0,rounding:2,width:35,zIndex:new a.Ry(1),children:(0,m.jsx)(a.xv,{color:"inverse",children:`${(r??0)+1}/${(l??[]).length}`})}):null}),y(this,"onLoadImage",()=>{this.setState({startImpressionTimer:!0}),this.props.onLoad?.()}),y(this,"onImageLoadError",()=>{this.setState({startImpressionTimer:!1}),this.props.onError?.()})}componentDidMount(){this.hideBadgeTimeout=setTimeout(()=>this.setState({showBadge:!1}),3e3)}componentDidUpdate(e){let{showBadge:t}=this.state,{carouselData:i}=e,{carouselData:n}=this.props;if(!i||!n)return;let{index:l}=i,{index:a}=n;t&&(this.hideBadgeTimeout&&clearTimeout(this.hideBadgeTimeout),this.hideBadgeTimeout=setTimeout(()=>this.setState({showBadge:!1}),3e3)),l!==a&&(this.hideBadgeTimeout&&clearTimeout(this.hideBadgeTimeout),this.setState({showBadge:!0}))}componentWillUnmount(){this.hideBadgeTimeout&&clearTimeout(this.hideBadgeTimeout)}render(){let e;let{isCloseup:t,carouselIndex:i,closeupHeight:n,closeupWidth:l=0,widthRatio:r=1,cropHeight:s,cropWidth:d,carouselData:c,disableTransition:h,highResOnly:y,pinId:v,imageSignature:b,isEditMode:_,isDenseView:w,isThirdPartyAd:k,_fixCompletedOnLoad:P}=this.props;if(!c)return null;if(r>1||r<0)throw Error("widthRatio should be between 0 and 1 inclusive");let{carouselSlots:T}=c,I=c.index??0,L=void 0!==i?i:I??0,{imageSizeMap:F}=T[L]||{},C=Math.floor((e=t?l:!t&&d||(y?474:w?o.Lo:o.yF))*r),j=F?.["236x"]||{},D=s||j.height||0,V=d||j.width||236,K=n||D/V*C,E=f(T);return(0,m.jsxs)(a.xu,{alignItems:"center","data-test-id":"carousel-pin","data-test-image-signature":b,display:"flex",height:K,minHeight:u.Ml,overflow:"hidden",children:[!_&&this.renderBadge(),(0,m.jsx)(p.lu,{carouselData:{...c,type:"canonical"},impressionType:"Pin",isPaused:!this.state.startImpressionTimer,loggingId:v,slotIndex:I??0,viewParameter:72,viewType:1,children:({impressionTrackerRef:e})=>(0,m.jsx)(a.xu,{ref:e,"data-test-id":`carousel-impression-ref-${v}-${I}`,height:K,overflow:"hidden",position:"absolute",width:C})},`carousel-impression-key-${L}`),(0,m.jsx)(a.xu,{dangerouslySetInlineStyle:{__style:{transition:h?"":"left .3s",left:(0,g.vF)(T.length,C,e,L)}},direction:"row",display:"flex",height:"100%",left:!0,position:"relative",width:C*T.length,children:T.map((i,a)=>{if(t){let t=a===T.length-1;return S({pinId:v,slot:i,slotIndex:a,onError:this.onImageLoadError,onLoad:this.onLoadImage,widthToUse:C,gap:C<e&&!t?1:0},this.props.i18n)}return x(P,this.props.i18n,i,v,a,y,this.onImageLoadError,this.onLoadImage,l,n,s,d,K,C,E,k)})})]})}}function _({pinKey:e,...t}){let i=(0,d.ZP)(),{checkExperiment:n}=(0,c.F)(),{isAuthenticated:l}=(0,h.B)(),a=(0,s.Z)(v,e),o=(0,r.Z)(a),u=o&&{...o,carouselSlots:function(e){let t=["236x","474x","564x","736x"].map(t=>{let i=Math.min(...e.map(e=>e.imageSizeMap?.[t]?.height||1/0)),n=Math.min(...e.map(e=>e.imageSizeMap?.[t]?.width||1/0));return{imageKey:t,height:i,width:n}});return e.map(e=>t.reduce((e,{imageKey:t,height:i,width:n})=>e.imageSizeMap?.[t]?{...e,imageSizeMap:{...e.imageSizeMap,[t]:{...e.imageSizeMap[t],height:i,width:n}}}:e,e))}(o.carouselSlots)};return(0,m.jsx)(b,{...t,carouselData:u,checkExperiment:n,i18n:i,imageSignature:a.imageSignature,isAuthenticated:l,pinId:a.entityId})}y(b,"defaultProps",{showCarouselBadge:!0})},107698:(e,t,i)=>{i.d(t,{CU:()=>s,GH:()=>u,Iw:()=>d,c3:()=>p,gA:()=>c,tD:()=>o,vF:()=>h,yR:()=>g});let n=({index:e,numberOfSlides:t,slidesShownPerPosition:i})=>t-e-Math.floor(i)<1,l=({slidesShownPerPosition:e,slotAndGapWidth:t})=>t-(e-parseInt(e,10))*t,a=({containerWidth:e,contentWidth:t,index:i,slotAndGapWidth:n})=>{let l=i-1,r=l*n;return t-r>=e?r:a({index:l,slotAndGapWidth:n,containerWidth:e,contentWidth:t})},r=({containerWidth:e,contentWidth:t,gap:i,index:n,slidesShownPerPosition:r,slotAndGapWidth:s,paddingX:o=0})=>a({containerWidth:e,contentWidth:t,index:n,slotAndGapWidth:s})+l({slidesShownPerPosition:r,slotAndGapWidth:s})-i+o,s=({containerWidth:e,gap:t,index:i,numberOfSlides:l,slotWidth:a,paddingX:s})=>{let o=a+t,d=o*l,u=s?e-s:e;if(d<=u)return 0;let c=u/o,h=n({index:i,numberOfSlides:l,slidesShownPerPosition:c})?r({containerWidth:u,contentWidth:d,gap:t,index:i,slidesShownPerPosition:c,slotAndGapWidth:o,paddingX:s}):i*o;return h?Math.round(-h):0},o=({containerWidth:e,gap:t,index:i,numberOfSlides:n,slotWidth:l,isHorizontalScrollable:a,paddingX:r})=>{let o=l*n+t*(n-1),d=r?e-r:e;return 0!==e&&(o<=d||(a?o<=d:Math.abs(s({containerWidth:e,gap:t,index:i,numberOfSlides:n,slotWidth:l,paddingX:r}))+t>=o-d))},d=({containerWidth:e,currentIndex:t,gap:i,index:n,numberOfSlides:l,slotWidth:a,paddingX:r})=>{let o=a+i,d=r?e-r:e;if(o*l<=d||0===e)return!0;let u=s({containerWidth:e,gap:i,index:t,numberOfSlides:l,slotWidth:a,paddingX:r}),c=r?d+o+r:e+o;return u+o*n<c},u=(e,t,i)=>e||`${t.bt("hình ảnh băng truyền", "carousel image", "Alternate text for a carousel image that indicates it is a carousel pin, with carousel index followed", undefined, true)} ${i}`,c=({highResOnly:e,slot:t})=>{let{images:i}=t;return e?`${i?.["736x"]?.url??""} 1x`:[i?.["474x"]&&`${i["474x"].url??""} 2x`,i?.["736x"]&&`${i["736x"].url??""} 3x`,i?.orig&&`${i.orig.url??""} 4x`].filter(Boolean).join(", ")},h=(e,t,i,n,l=0,a)=>{let r=a?i-a:i;if(r===t)return-(n*t*1)+(a||0);let s=Math.floor(r-t),o=t+l;return n===e-1?-1*n*o+s+(a||0):-1*n*o+(a||0)},g=(e,t,i,n,l,a,r)=>{if(!e||t<=0)return 0;let s=Math.floor(i*n),o=e?.clientWidth||a*s;return Math.round(((r?t-r:t)+(r?o-r:o)-s/2)/(s+l))-1},p=(e,t,i,n,l,a)=>{e.current&&t&&e.current.scrollBy({left:(i-n)*(l+a),behavior:"smooth"})}},966875:(e,t,i)=>{i.d(t,{ZP:()=>T});var n,l=i(667294);i(422578);var a=i(883119),r=i(573706),s=i(955937),o=i(384609),d=i(766546),u=i(297728),c=i(707676),h=i(644797),g=i(299897),p=i(964973),m=i(785893);function y(e,t,i){var n;return(t="symbol"==typeof(n=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,t||"default");if("object"!=typeof n)return n;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?n:n+"")in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}let v=(0,p.Z)(()=>Promise.all([i.e(97270),i.e(93041),i.e(88782),i.e(95813)]).then(i.bind(i,99773)),void 0,e=>99773,"app-www-video-VideoWrapper"),f=[0,.25,.5,.75,.95,.97],x=[0,.5,.8,.99,1],S={rootMargin:"-64px 0px 0px 0px",threshold:[...g.iM]},b=Object.freeze({LOADING:0,PLAYING:1,PAUSED:2,STALLING:3}),_=void 0!==n?n:n=i(981102);function w(){return new Date().getTime()}function k(e){return!!e.volume&&e.volume>0}class P extends l.Component{constructor(e){super(e),y(this,"videoWrapperRef",(0,l.createRef)()),y(this,"handleWindowResize",()=>{if(!this.fullscreen){let e=this.getDimensions(),{height:t,width:i}=this.currentInterval;e.height!==t||e.width!==i?this.startNewInterval(e):(this.currentInterval.windowHeight=e.windowHeight,this.currentInterval.windowWidth=e.windowWidth)}}),y(this,"handlePlayheadDown",({event:e})=>{let{onPlayheadDown:t}=this.props;this.setState({seeking:!0}),t&&t({event:e})}),y(this,"handlePlayheadUp",({event:e})=>{let{onPlayheadUp:t}=this.props;this.setState({seeking:!1}),t&&t({event:e})}),y(this,"handleLoop",()=>{this.videoTime=0}),y(this,"handlePlaying",e=>{this.logVideoStart(),this.props.onPlaying&&this.props.onPlaying(e)}),y(this,"handleTimeChange",e=>{let{seeking:t,ready:i}=this.state;if(!this.currentInterval.videoDuration)return;let n=1e3*e.time,l=function(e,t,i,n){if(e>t||i<=0)return null;for(let l of n){let n=l*i;if(e<=n&&t>n)return l}return null}(this.videoTime,n,this.currentInterval.videoDuration,f);if("number"==typeof l&&this.props.playing&&!t&&i){let e=w();this.logVideoEvent(6906,{...this.currentInterval,startTime:e,endTime:e,videoStartTime:0,videoEndTime:0,quartile:Math.floor(4*l),quartilePercentValue:l})}this.videoTime=n,this.props.onTimeChange&&this.props.onTimeChange(e)}),y(this,"handleDurationChange",e=>{this.currentInterval.videoDuration=1e3*e.duration,this.props.onDurationChange&&this.props.onDurationChange(e)}),y(this,"handleReady",e=>{let{ready:t}=this.state;t||this.setState({ready:!0}),this.props.onReady&&this.props.onReady(e)}),y(this,"handleEnded",e=>{this.logFourthQuartileEvent(),this.props.loop&&(this.startNewInterval(),this.currentInterval.videoStartTime=0),this.props.onEnded&&this.props.onEnded(e)}),y(this,"handleVisibilityChange",e=>{if(0===e.length)return;let t=function(e,t){for(let i=0;i<t.length;i+=1){let n=t[i],l=t[i+1];if(null==l||n<=e&&e<l)return n}return null}(Number.parseFloat(e.slice(-1)[0].intersectionRatio.toFixed(2)),x);"number"==typeof t&&(this.visible=t>=.5),null==t||t===this.currentInterval.viewability||this.fullscreen||(0===t?this.startNewInterval({viewability:t,playbackState:b.PAUSED}):this.startNewInterval({viewability:t}))}),y(this,"handleFullscreenChange",({event:e,fullscreen:t})=>{if(t){let{height:e,width:t}=window.screen;this.startNewInterval({height:e,width:t,windowHeight:e,windowWidth:t})}else t||this.startNewInterval(this.getDimensions());this.fullscreen=t,this.props.onFullscreenChange&&this.props.onFullscreenChange({event:e,fullscreen:t})}),y(this,"handleClose",()=>{this.startNewInterval()}),this.state={ready:!1,seeking:!1,started:!1};let t=w();this.handleWindowResize=(0,s.Z)(this.handleWindowResize,1e3),this.currentInterval={videoDuration:0,startTime:t,endTime:t,videoStartTime:0,videoEndTime:0,isAudible:k(e),playbackState:this.getPlaybackState(e,this.state),quartile:-1,quartilePercentValue:0,height:null,width:null,windowHeight:null,windowWidth:null,viewability:null},this.videoTime=0,this.fullscreen=!1,this.visible=null}componentDidMount(){this.currentInterval={...this.currentInterval,...this.getDimensions()},window.addEventListener("resize",this.handleWindowResize),window.addEventListener("beforeunload",this.handleClose)}componentDidUpdate(e,t){let i={};k(e)&&!k(this.props)?i.isAudible=!1:!k(e)&&k(this.props)&&(i.isAudible=!0);let n=this.getPlaybackState(this.props,this.state);this.getPlaybackState(e,t)!==n&&(i.playbackState=n),Object.keys(i).length>0&&this.startNewInterval(i)}componentWillUnmount(){window.removeEventListener("resize",this.handleWindowResize),window.removeEventListener("beforeunload",this.handleClose),this.startNewInterval()}getPlaybackState(e,t){return t.ready?e.playing&&!t.seeking?b.PLAYING:b.PAUSED:b.LOADING}getDimensions(){let e,t;if(this.videoWrapperRef.current){let i=this.videoWrapperRef.current;i.clientHeight&&i.clientWidth&&(e=i.clientHeight,t=i.clientWidth)}return{height:e,width:t,windowHeight:window.innerHeight,windowWidth:window.innerWidth}}logVideoEvent(e,t){let{closeupStoryPinViewability:i,contextLogData:n,logContextEvent:l,playing:a,surface:r}=this.props,{seeking:s}=this.state,{height:o,width:d,windowHeight:u,windowWidth:c,viewability:h,...g}=t;if(null!=o&&null!=d&&null!=u&&null!=c&&null!=h){let t={...g,gridAutoplay:6904===e&&a&&!s&&("AuthHomefeed"===r||"SearchItem"===r||"RelatedPinGrid"===r||"PdpRelatedPinGrid"===r),height:o,width:d,windowHeight:u,windowWidth:c,viewability:i||h};l({event_type:e,...function(e){let{eventData:{videoEvent:{gridAutoplay:t,videoDuration:i,startTime:n,endTime:l,videoStartTime:a,videoEndTime:r,isAudible:s,height:o,width:d,playbackState:u,quartile:c,quartilePercentValue:h,windowHeight:g,windowWidth:p,viewability:m}},component:y,objectId:v,view:f,viewParameter:x,...S}=e;return{component:y,object_id_str:v,view_type:f,view_parameter:x,aux_data:{...S},event_data:{videoEventData:{gridAutoplay:t,videoDuration:i?Math.floor(i):0,time:n,endTime:l,videoTime:a?Math.floor(a):0,endVideoTime:r?Math.floor(r):0,isAudible:s,height:o,width:d,playbackState:u,quartile:c,quartilePercentValue:h,windowHeight:g,windowWidth:p,viewability:m}}}}({...n,view:this.fullscreen?108:n.view,eventData:{videoEvent:t}})})}}logFourthQuartileEvent(){let e=w();this.logVideoEvent(6906,{...this.currentInterval,startTime:e,endTime:e,videoStartTime:0,videoEndTime:0,quartile:4,quartilePercentValue:1})}logVideoStart(){if(this.state.started)return;let{contextLogData:e,setVideoPlayed:t,shouldLogVideoStart:i}=this.props;if(i){let e=w();this.logVideoEvent(3621,{...this.currentInterval,startTime:e,endTime:e,videoEndTime:this.videoTime})}t(e.objectId),this.setState({started:!0})}startNewInterval(e){let t=w();this.logVideoEvent(6904,{...this.currentInterval,endTime:t,videoEndTime:this.videoTime}),this.currentInterval={...this.currentInterval,...e,startTime:t,videoStartTime:this.videoTime,endTime:-1,videoEndTime:-1}}render(){let{rootMargin:e,surface:t,aspectRatio:i,backgroundColor:n,captions:l,contextLogData:r,controls:s,fallback:o,hlsConfig:u,isAutoPlay:h,loop:g,objectFit:p,onLoadedChange:y,onControlsPause:f,onControlsPlay:x,onSeek:b,onVolumeChange:_,pin:w,playbackRate:k,playing:P,playsInline:T,poster:I,preload:L,seekTime:F,src:C,videoStartTime:j,volume:D,video:V}=this.props,{seeking:K}=this.state;return void 0!==e&&(S.rootMargin=t?(0,c.eL)(t):e),(0,m.jsx)(d.Z,{onVisibilityChange:this.handleVisibilityChange,options:S,children:e=>(0,m.jsx)(a.xu,{ref:t=>{e.current=t,this.videoWrapperRef.current=t},height:"inherit",children:(0,m.jsx)(v,{aspectRatio:i,backgroundColor:n,captions:l,contextLogData:r,controls:s,fallback:o,hlsConfig:u,isAutoPlay:h,loop:g,objectFit:p,onControlsPause:f,onControlsPlay:x,onDurationChange:this.handleDurationChange,onEnded:this.handleEnded,onFullscreenChange:this.handleFullscreenChange,onLoadedChange:y,onLoop:this.handleLoop,onPlay:()=>{},onPlayError:()=>{},onPlayheadDown:this.handlePlayheadDown,onPlayheadUp:this.handlePlayheadUp,onPlaying:this.handlePlaying,onReady:this.handleReady,onSeek:b,onTimeChange:this.handleTimeChange,onVolumeChange:_,pinKey:w,playbackRate:k,playing:!K&&P,playsInline:T,poster:I,preload:L,seekTime:F,src:C,video:V,videoStartTime:j,visible:this.visible,volume:D})})})}}function T(e){let{pinKey:t}=e,i=(0,o.Z)(_,t),{logContextEvent:n}=(0,r.v)(),{checkExperiment:l}=(0,u.F)(),{setVideoPlayed:a}=(0,h.r)(),s=l("web_video_start_log").anyEnabled;return(0,m.jsx)(P,{...e,logContextEvent:n,pin:i,setVideoPlayed:a,shouldLogVideoStart:s})}y(P,"defaultProps",a.nk.defaultProps)},299897:(e,t,i)=>{i.d(t,{Ul:()=>a,VS:()=>n,hy:()=>r,iM:()=>l,j4:()=>s});let n=2,l=[0,.01,.02,.03,.04,.05,.06,.07,.08,.09,.1,.11,.12,.13,.14,.15,.16,.17,.18,.19,.2,.21,.22,.23,.24,.25,.26,.27,.28,.29,.3,.31,.32,.33,.34,.35,.36,.37,.38,.39,.4,.41,.42,.43,.44,.45,.46,.47,.48,.49,.5,.51,.52,.53,.54,.55,.56,.57,.58,.59,.6,.61,.62,.63,.64,.65,.66,.67,.68,.69,.7,.71,.72,.73,.74,.75,.76,.77,.78,.79,.8,.81,.82,.83,.84,.85,.86,.87,.88,.89,.9,.91,.92,.93,.94,.95,.96,.97,.98,.99,1],a={backgroundImage:"linear-gradient(to top, rgba(0, 0, 0, .4), rgba(0, 0, 0, 0))",pointerEvents:"none",bottom:0},r=128,s=e=>e&&document.querySelector(`video[poster="${e}"]`)||null}}]);
//# sourceMappingURL=https://sm.pinimg.com/webapp/PinVideoWithVisibilityWrapper.vi_VN-4070a0123fc35dc2.mjs.map